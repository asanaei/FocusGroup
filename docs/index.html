<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>FocusGroup • FocusGroup</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="FocusGroup">
<meta name="description" content="LLM-Powered Focus Group Simulation and Analysis">
<meta property="og:description" content="LLM-Powered Focus Group Simulation and Analysis">
<meta property="og:image" content="https://asanaei.github.io/FocusGroup/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">FocusGroup</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/asanaei/FocusGroup" aria-label="GitHub repository"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="focusgroup-llm-powered-focus-group-simulation-and-analysis">FocusGroup: LLM-Powered Focus Group Simulation and Analysis<a class="anchor" aria-label="anchor" href="#focusgroup-llm-powered-focus-group-simulation-and-analysis"></a>
</h1>
</div>
<p><img src="reference/figures/logo.png" alt="FocusGroup icon" width="120" class="d-none"></p>
<p><a href="https://github.com/asanaei/FocusGroup/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/asanaei/FocusGroup/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a> <a href="https://asanaei.github.io/FocusGroup/"><img src="https://img.shields.io/badge/docs-pkgdown-blue.svg" alt="pkgdown"></a> <a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a> <a href="https://asanaei.github.io/FocusGroup/"><img src="https://img.shields.io/badge/docs-pkgdown-blue" alt="Website"></a></p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>FocusGroup</code> package provides a comprehensive R6-based framework for simulating and analyzing focus group discussions using Large Language Models (LLMs). It enables researchers to create virtual focus groups with diverse AI agents, conduct structured discussions across multiple phases, and perform sophisticated analysis of the resulting conversations.</p>
<p>The package is designed with flexibility in mind, allowing users to define agent personas, manage conversation flow, and customize prompts for LLM interactions.</p>
</div>
<div class="section level2">
<h2 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h2>
<ul>
<li>
<strong>Agent-Based Modeling</strong>: Create diverse AI participants and moderators (<code>FGAgent</code> class) with customizable personas derived from demographics, survey responses, or direct descriptions. Each agent can have its own LLM configuration.</li>
<li>
<strong>Flexible Conversation Flow</strong>: Implement various turn-taking mechanisms using the <code>ConversationFlow</code> base class and its implementations:
<ul>
<li>
<code>RoundRobinFlow</code>: Participants take turns in a fixed order.</li>
<li>
<code>ProbabilisticFlow</code>: Turn-taking based on dynamically adjusting propensity scores.</li>
<li>
<code>DesireBasedFlow</code>: LLM-rated “desire to talk” determines the next speaker.</li>
</ul>
</li>
<li>
<strong>Phase-Driven Simulations</strong>: The <code>FocusGroup</code> class orchestrates discussions through a <code>question_script</code> that defines phases (e.g., Opening, Icebreaker, Engagement, Exploration, Closing) and moderator actions.</li>
<li>
<strong>Comprehensive Analysis</strong>: The <code>FocusGroup</code> class includes methods for basic conversation statistics, and the <code>analyze_focus_group</code> wrapper provides a higher-level interface for more detailed analyses (topic modeling, sentiment, TF-IDF, readability, thematic analysis).</li>
<li>
<strong>Customizable Prompts</strong>: Default prompts are provided (<code><a href="reference/get_default_prompt_templates.html">get_default_prompt_templates()</a></code>), but users can supply their own to tailor agent behavior.</li>
<li>
<strong>LLM Integration</strong>: Leverages the <code>LLMR</code> package for robust interaction with various LLM providers.</li>
</ul>
</div>
<div class="section level2">
<h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h2>
<p>The package is experimental, with some rough edges. The intention is to keep the core of the two classes (<code>FGAgent</code> and <code>FocusGroup</code>) unchanged, but update the methods and functions that interact with them.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install from GitHub (replace with your actual repository if different)</span></span>
<span><span class="co"># remotes::install_github("asanaei/FocusGroup")</span></span>
<span></span>
<span><span class="co"># Or, if you have a local tar.gz file:</span></span>
<span><span class="co"># install.packages("path/to/your/FocusGroupPackage_version.tar.gz", repos = NULL, type = "source")</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h2>
<p>Ensure the following R packages are installed:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R6"</span>, <span class="st">"LLMR"</span>, <span class="st">"dplyr"</span>, <span class="st">"tidyr"</span>, <span class="st">"ggplot2"</span>, </span>
<span>                   <span class="st">"quanteda"</span>, <span class="st">"quanteda.textstats"</span>, <span class="st">"topicmodels"</span>, <span class="st">"tidytext"</span>, <span class="st">"stringr"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>You will also need to configure API keys for your chosen LLM provider (e.g., set <code>OPENAI_API_KEY</code> as an environment variable if using OpenAI via <code>LLMR</code>).</p>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="section level3">
<h3 id="id_1-simple-focus-group-simulation-using-run_focus_group">1. Simple Focus Group Simulation using <code>run_focus_group</code>
<a class="anchor" aria-label="anchor" href="#id_1-simple-focus-group-simulation-using-run_focus_group"></a>
</h3>
<p>The <code>run_focus_group</code> function is a high-level wrapper to quickly set up and run a simulation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/asanaei/FocusGroup" class="external-link">FocusGroup</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/asanaei/LLMR" class="external-link">LLMR</a></span><span class="op">)</span> <span class="co"># For llm_config</span></span>
<span></span>
<span><span class="co"># Ensure OPENAI_API_KEY is set in your environment</span></span>
<span><span class="co"># Sys.setenv(OPENAI_API_KEY = "your-openai-api-key")</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"OPENAI_API_KEY"</span><span class="op">)</span> <span class="op">==</span> <span class="st">""</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Please set your OPENAI_API_KEY environment variable."</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Define LLM configuration for agents</span></span>
<span><span class="va">llm_config_agents</span> <span class="op">&lt;-</span> <span class="fu">LLMR</span><span class="fu">::</span><span class="fu"><a href="https://asanaei.github.io/LLMR/reference/llm_config.html" class="external-link">llm_config</a></span><span class="op">(</span></span>
<span>  provider <span class="op">=</span> <span class="st">"openai"</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"gpt-4o-mini"</span>, <span class="co"># Or your preferred model</span></span>
<span>  temperature <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  max_tokens <span class="op">=</span> <span class="fl">200</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run a basic focus group</span></span>
<span><span class="co"># `turns_per_phase` will generate a generic script structure.</span></span>
<span><span class="co"># The moderator prompts will adapt to the topic and phase.</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/run_focus_group.html">run_focus_group</a></span><span class="op">(</span></span>
<span>  topic <span class="op">=</span> <span class="st">"The impact of remote work on team collaboration"</span>,</span>
<span>  participants <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  turns_per_phase <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Opening <span class="op">=</span> <span class="fl">1</span>, Icebreaker <span class="op">=</span> <span class="fl">2</span>, Engagement <span class="op">=</span> <span class="fl">5</span>, Exploration <span class="op">=</span> <span class="fl">6</span>, Closing <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  llm_config <span class="op">=</span> <span class="va">llm_config_agents</span>, <span class="co"># Used for all agents and admin tasks if not specified otherwise</span></span>
<span>  seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Access the conversation log</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"First 5 turns of the conversation:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">conversation</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View basic statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Basic conversation statistics:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">basic_stats</span><span class="op">$</span><span class="va">speaker_stats</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Focus group summary:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_2-more-detailed-simulation-setup-using-r6-classes-directly">2. More Detailed Simulation Setup (using R6 classes directly)<a class="anchor" aria-label="anchor" href="#id_2-more-detailed-simulation-setup-using-r6-classes-directly"></a>
</h3>
<p>For more control, you can instantiate the R6 classes directly.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/asanaei/FocusGroup" class="external-link">FocusGroup</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/asanaei/LLMR" class="external-link">LLMR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sys.setenv(OPENAI_API_KEY = "your-openai-api-key") # Ensure API key is set</span></span>
<span></span>
<span><span class="co"># a. Define LLM Configuration</span></span>
<span><span class="va">llm_conf</span> <span class="op">&lt;-</span> <span class="fu">LLMR</span><span class="fu">::</span><span class="fu"><a href="https://asanaei.github.io/LLMR/reference/llm_config.html" class="external-link">llm_config</a></span><span class="op">(</span></span>
<span>  provider <span class="op">=</span> <span class="st">"openai"</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"gpt-4o-mini"</span>,</span>
<span>  temperature <span class="op">=</span> <span class="fl">0.7</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># b. Create Agents (using create_diverse_agents or manually)</span></span>
<span><span class="co"># `create_diverse_agents` generates diverse demographics and basic personas.</span></span>
<span><span class="co"># It also creates a moderator.</span></span>
<span><span class="va">all_agents_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_diverse_agents.html">create_diverse_agents</a></span><span class="op">(</span></span>
<span>  n_participants <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  llm_config <span class="op">=</span> <span class="va">llm_conf</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># The list needs to be named by agent ID for FocusGroup class</span></span>
<span><span class="va">all_agents_named</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">all_agents_list</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">all_agents_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="va">a</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">moderator_id</span> <span class="op">&lt;-</span> <span class="st">"MOD"</span> <span class="co"># Default ID from create_diverse_agents</span></span>
<span></span>
<span><span class="co"># c. Define a Custom Question Script</span></span>
<span><span class="va">custom_script</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>phase <span class="op">=</span> <span class="st">"opening"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>phase <span class="op">=</span> <span class="st">"icebreaker_question"</span>, text <span class="op">=</span> <span class="st">"What's one word that describes your ideal weekend?"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>phase <span class="op">=</span> <span class="st">"engagement_question"</span>, text <span class="op">=</span> <span class="st">"How do you typically spend your weekends?"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>phase <span class="op">=</span> <span class="st">"exploration_question"</span>, text <span class="op">=</span> <span class="st">"What makes a weekend truly relaxing or fulfilling for you?"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>phase <span class="op">=</span> <span class="st">"closing"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># d. Choose a Conversation Flow</span></span>
<span><span class="co"># desire_flow &lt;- DesireBasedFlow$new(agents = all_agents_named, moderator_id = moderator_id)</span></span>
<span><span class="va">round_robin_flow</span> <span class="op">&lt;-</span> <span class="va"><a href="reference/RoundRobinFlow.html">RoundRobinFlow</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>agents <span class="op">=</span> <span class="va">all_agents_named</span>, moderator_id <span class="op">=</span> <span class="va">moderator_id</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># e. Create FocusGroup Object</span></span>
<span><span class="va">fg_manual</span> <span class="op">&lt;-</span> <span class="va"><a href="reference/FocusGroup.html">FocusGroup</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  topic <span class="op">=</span> <span class="st">"Weekend Preferences and Activities"</span>,</span>
<span>  purpose <span class="op">=</span> <span class="st">"To understand how people like to spend their weekends."</span>,</span>
<span>  agents <span class="op">=</span> <span class="va">all_agents_named</span>,</span>
<span>  moderator_id <span class="op">=</span> <span class="va">moderator_id</span>,</span>
<span>  turn_taking_flow <span class="op">=</span> <span class="va">round_robin_flow</span>, <span class="co"># Using round robin for this example</span></span>
<span>  question_script <span class="op">=</span> <span class="va">custom_script</span>,</span>
<span>  llm_config_admin <span class="op">=</span> <span class="va">llm_conf</span> <span class="co"># For summaries etc.</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># f. Run Simulation</span></span>
<span><span class="va">fg_manual</span><span class="op">$</span><span class="fu">run_simulation</span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># g. Analyze</span></span>
<span><span class="va">conversation_df_manual</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">fg_manual</span><span class="op">$</span><span class="va">conversation_log</span>, <span class="va">as.data.frame</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Manually setup conversation (first 5 turns):"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">conversation_df_manual</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summary_manual</span> <span class="op">&lt;-</span> <span class="va">fg_manual</span><span class="op">$</span><span class="fu">summarize</span><span class="op">(</span>summary_level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nSummary from manual setup:\n"</span>, <span class="va">summary_manual</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="main-classes">Main Classes<a class="anchor" aria-label="anchor" href="#main-classes"></a>
</h2>
<div class="section level3">
<h3 id="fgagent">
<code>FGAgent</code><a class="anchor" aria-label="anchor" href="#fgagent"></a>
</h3>
<p>Represents an individual participant or moderator. - <strong>Key Fields</strong>: <code>id</code>, <code>persona_description</code>, <code>communication_style_instruction</code>, <code>model_config</code>, <code>is_moderator</code>. - <strong>Key Methods</strong>: - <code>initialize(id, agent_details, model_config, is_moderator)</code>: Creates an agent. <code>agent_details</code> can include <code>direct_persona_description</code>, <code>demographics</code>, <code>survey_responses</code>, <code>communication_style</code>. - <code>generate_utterance(...)</code>: Generates text based on context and prompts. - <code>get_need_to_talk(...)</code>: (Used by <code>DesireBasedFlow</code>) Queries LLM for agent’s desire to speak.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example FGAgent creation</span></span>
<span><span class="va">participant_details</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  direct_persona_description <span class="op">=</span> <span class="st">"A 35-year-old software engineer who enjoys hiking and is concerned about data privacy."</span>,</span>
<span>  communication_style <span class="op">=</span> <span class="st">"analytical and tends to ask clarifying questions"</span>,</span>
<span>  demographics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">35</span>, occupation <span class="op">=</span> <span class="st">"Software Engineer"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># llm_conf defined earlier</span></span>
<span><span class="va">agent1</span> <span class="op">&lt;-</span> <span class="va"><a href="reference/FGAgent.html">FGAgent</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"P1"</span>, agent_details <span class="op">=</span> <span class="va">participant_details</span>, model_config <span class="op">=</span> <span class="va">llm_conf</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="focusgroup">
<code>FocusGroup</code><a class="anchor" aria-label="anchor" href="#focusgroup"></a>
</h3>
<p>Manages the overall simulation, conversation flow, logging, and analysis. - <strong>Key Fields</strong>: <code>topic</code>, <code>purpose</code>, <code>agents</code> (named list), <code>moderator_id</code>, <code>conversation_log</code>, <code>turn_taking_flow</code>, <code>question_script</code>, <code>prompt_templates</code>. - <strong>Key Methods</strong>: - <code>initialize(...)</code>: Sets up the focus group. - <code>run_simulation(num_turns, verbose)</code>: Executes the simulation. - <code>advance_turn(current_turn_number, verbose)</code>: Core logic for a single moderator-participant exchange. - <code>summarize(summary_level, ...)</code>: Generates an LLM-based summary of the conversation. - <code>analyze()</code>: Provides basic conversation statistics. - <code>analyze_topics()</code>, <code>analyze_tfidf()</code>, <code>analyze_readability()</code>, <code>analyze_themes()</code>: Various detailed analysis methods. - Plotting methods like <code>plot_participation_timeline()</code>, <code>plot_word_count_distribution()</code>, etc.</p>
</div>
<div class="section level3">
<h3 id="conversationflow-and-subclasses">
<code>ConversationFlow</code> (and subclasses)<a class="anchor" aria-label="anchor" href="#conversationflow-and-subclasses"></a>
</h3>
<p>Defines how the next speaker is chosen. - Base class: <code>ConversationFlow</code> - Implementations: - <code>RoundRobinFlow</code>: Cycles through participants. - <code>ProbabilisticFlow</code>: Uses weighted probabilities based on speaking history and base propensities. - <code>DesireBasedFlow</code>: Uses LLM to assess each participant’s “desire to talk”. - Created via <code>create_conversation_flow(mode, agents, moderator_id, flow_params)</code> or by direct instantiation.</p>
</div>
</div>
<div class="section level2">
<h2 id="advanced-usage-working-with-survey-data-eg-anes">Advanced Usage: Working with Survey Data (e.g., ANES)<a class="anchor" aria-label="anchor" href="#advanced-usage-working-with-survey-data-eg-anes"></a>
</h2>
<p>The package is designed to allow agent personas to be informed by survey data. The <code>create_diverse_agents</code> function (and by extension, <code>run_focus_group</code>) can accept <code>demographics</code> and <code>survey_responses</code> data frames.</p>
<p><strong>Key Idea</strong>: If <code>direct_persona_description</code> is NOT provided in <code>agent_details</code>, <code>FGAgent$new</code> (via <code>create_diverse_agents</code> and its internal <code>generate_persona</code> function) should ideally be able to: 1. Use the <code>demographics</code> data frame for basic demographic facts. 2. Iterate through columns in the <code>survey_responses</code> data frame for a given agent. 3. For each survey variable (column): * Retrieve the question text (variable label from Haven attributes, e.g., <code>attr(column, "label")</code>). * Retrieve the textual representation of the coded answer (value label from Haven attributes, e.g., by using <code><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">haven::as_factor()</a></code> then <code><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character()</a></code>, or by looking up <code>attr(column, "labels")</code>). * Incorporate this “Question: …, Answer: …” information into the <code>persona_description</code> passed to the LLM.</p>
</div>
<div class="section level2">
<h2 id="customizing-prompts">Customizing Prompts<a class="anchor" aria-label="anchor" href="#customizing-prompts"></a>
</h2>
<p>You can tailor the LLM’s behavior by modifying the default prompt templates.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the list of default prompts</span></span>
<span><span class="va">default_prompts</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_default_prompt_templates.html">get_default_prompt_templates</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Modify a specific prompt, e.g., for the moderator's opening</span></span>
<span><span class="va">default_prompts</span><span class="op">$</span><span class="va">moderator_opening</span> <span class="op">&lt;-</span> <span class="st">"Hello everyone, and a very warm welcome! Today we're diving into {{topic}}. Our goal is {{focus_group_purpose}}. Let's make this a great discussion."</span></span>
<span></span>
<span><span class="co"># When creating your FocusGroup object:</span></span>
<span><span class="co"># fg &lt;- FocusGroup$new(</span></span>
<span><span class="co">#   ...,</span></span>
<span><span class="co">#   prompt_templates = default_prompts,</span></span>
<span><span class="co">#   ...</span></span>
<span><span class="co"># )</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analysis-capabilities">Analysis Capabilities<a class="anchor" aria-label="anchor" href="#analysis-capabilities"></a>
</h2>
<p>The <code>FocusGroup</code> class offers several built-in analysis methods: - <code>analyze()</code>: Basic statistics (turn counts, word counts). - <code>analyze_topics(num_topics = 5, ...)</code>: LDA topic modeling. - <code>analyze_tfidf(top_n_terms = 10, ...)</code>: Term Frequency-Inverse Document Frequency. - <code>analyze_readability(measures = "Flesch", ...)</code>: Readability scores. - <code>analyze_themes(...)</code>: LLM-assisted thematic analysis. - <code>analyze_participation_balance(...)</code>, <code>analyze_response_patterns(...)</code>, <code>analyze_question_patterns(...)</code>, <code>analyze_key_phrases(...)</code>: More specialized text and interaction analyses.</p>
<p>The <code><a href="reference/analyze_focus_group.html">analyze_focus_group()</a></code> wrapper function provides a convenient way to run several of these analyses at once.</p>
</div>
<div class="section level2">
<h2 id="visualizations">Visualizations<a class="anchor" aria-label="anchor" href="#visualizations"></a>
</h2>
<p>The <code>FocusGroup</code> class also includes plotting methods: - <code>plot_participation_timeline()</code> - <code>plot_word_count_distribution()</code> - <code>plot_participation_by_agent()</code> - <code>plot_turn_length_timeline()</code></p>
<p>These are also accessible via the <code>plots</code> element in the output of <code><a href="reference/analyze_focus_group.html">analyze_focus_group()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>Contributions, bug reports, and feature requests are welcome! Please open an issue or submit a pull request on the <a href="https://github.com/asanaei/FocusGroup" class="external-link">GitHub repository</a>. <!-- Update link --></p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>This project is licensed under the MIT License - see the <code>LICENSE</code> file for details.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/asanaei/FocusGroup/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/asanaei/FocusGroup/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing FocusGroup</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="mailto:sanaei@uchicago.edu">Ali Sanaei</a> <br><small class="roles"> Maintainer </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="mailto:sanaei@uchicago.edu">Ali Sanaei</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
